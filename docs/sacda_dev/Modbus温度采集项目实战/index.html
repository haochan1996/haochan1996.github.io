<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-sacda_dev/Modbus温度采集项目实战" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Modbus温度采集项目实战 | 知白守黑</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://haochan1996.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://haochan1996.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://haochan1996.github.io/docs/sacda_dev/Modbus温度采集项目实战"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Modbus温度采集项目实战 | 知白守黑"><meta data-rh="true" name="description" content="RS-485串口通讯基础"><meta data-rh="true" property="og:description" content="RS-485串口通讯基础"><link data-rh="true" rel="icon" href="/img/taichi.png"><link data-rh="true" rel="canonical" href="https://haochan1996.github.io/docs/sacda_dev/Modbus温度采集项目实战"><link data-rh="true" rel="alternate" href="https://haochan1996.github.io/docs/sacda_dev/Modbus温度采集项目实战" hreflang="en"><link data-rh="true" rel="alternate" href="https://haochan1996.github.io/docs/sacda_dev/Modbus温度采集项目实战" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="知白守黑 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="知白守黑 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.02284d34.css">
<script src="/assets/js/runtime~main.43eec468.js" defer="defer"></script>
<script src="/assets/js/main.7da07234.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/taichi.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/taichi.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/taichi.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">雪煎陈茶</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/c上位机开发">文档</a><a class="navbar__item navbar__link" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/haochan1996/haochan1996.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/c上位机开发">C#上位机开发</a><button aria-label="Collapse sidebar category &#x27;C#上位机开发&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/sacda_dev/Modbus温度采集项目实战">Modbus温度采集项目实战</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/autojs使用">auto.js使用</a><button aria-label="Expand sidebar category &#x27;auto.js使用&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/仓颉编程语言学习入门">仓颉编程语言学习入门</a><button aria-label="Expand sidebar category &#x27;仓颉编程语言学习入门&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/pyside6进行gui编程">PySide6进行GUI编程</a><button aria-label="Expand sidebar category &#x27;PySide6进行GUI编程&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/office办公软件使用">office办公软件使用</a><button aria-label="Expand sidebar category &#x27;office办公软件使用&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/rust编程入门实战与进阶朱春雷">Rust编程：入门、实战与进阶（朱春雷）</a><button aria-label="Expand sidebar category &#x27;Rust编程：入门、实战与进阶（朱春雷）&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/c上位机开发"><span itemprop="name">C#上位机开发</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Modbus温度采集项目实战</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Modbus温度采集项目实战</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="rs-485串口通讯基础">RS-485串口通讯基础<a href="#rs-485串口通讯基础" class="hash-link" aria-label="Direct link to RS-485串口通讯基础" title="Direct link to RS-485串口通讯基础">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="串口通讯硬件接线">串口通讯硬件接线<a href="#串口通讯硬件接线" class="hash-link" aria-label="Direct link to 串口通讯硬件接线" title="Direct link to 串口通讯硬件接线">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520144300919.png" alt="image-20250520144300919" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="串口通讯数据流和格式">串口通讯数据流和格式<a href="#串口通讯数据流和格式" class="hash-link" aria-label="Direct link to 串口通讯数据流和格式" title="Direct link to 串口通讯数据流和格式">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520145655518.png" alt="image-20250520145655518" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="串行通信格式单字节协议">串行通信格式（单字节协议）<a href="#串行通信格式单字节协议" class="hash-link" aria-label="Direct link to 串行通信格式（单字节协议）" title="Direct link to 串行通信格式（单字节协议）">​</a></h3>
<p>常用：（9600，N，8，1）波特率9600b/s，无奇偶校验位，8位数据位，1位停止位</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="modbus通讯协议">Modbus通讯协议<a href="#modbus通讯协议" class="hash-link" aria-label="Direct link to Modbus通讯协议" title="Direct link to Modbus通讯协议">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="关于通讯协议">关于通讯协议<a href="#关于通讯协议" class="hash-link" aria-label="Direct link to 关于通讯协议" title="Direct link to 关于通讯协议">​</a></h3>
<p>不同设备之间交换数据要遵循的规范。就好比人与人之间交流用的语言，必须要有语法。通常情况下，串行通信遵守Modbus协议串口硬件(RS-232、RS-485、RS-422)都是按照Modbus协议。但是Modbus也可以用于以太网TCP/IP通信。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="modbus与串口的关系">Modbus与串口的关系<a href="#modbus与串口的关系" class="hash-link" aria-label="Direct link to Modbus与串口的关系" title="Direct link to Modbus与串口的关系">​</a></h4>
<ol>
<li>串口通讯物理接口：RS232、RS-485、RS-422接口，是硬件</li>
<li>Modbus是国际标准的串口通讯协议，是软件</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="modbus与串行通信关系">Modbus与串行通信关系<a href="#modbus与串行通信关系" class="hash-link" aria-label="Direct link to Modbus与串行通信关系" title="Direct link to Modbus与串行通信关系">​</a></h4>
<ol>
<li>
<p>前面所讲串行通信格式:表示一个字节的传输协议(9600，N，8,1)，实际应用中数据传送都是多个串行字节组合到一起。</p>
<p>问题:如何识别多个字节?也就是对多个串行字节传输和解析的标准怎么规定?Modbus就是这个作用。</p>
</li>
<li>
<p>Modbus:就是如何用串口一次连续传输多个有序字节的协议。它规定了一次发送多少给字节，以及字节顺序如何排列。</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="modbus网络传输的三种模式">Modbus网络传输的三种模式<a href="#modbus网络传输的三种模式" class="hash-link" aria-label="Direct link to Modbus网络传输的三种模式" title="Direct link to Modbus网络传输的三种模式">​</a></h4>
<ol>
<li>
<p>ASCII模式：G标准信息交换码(0-9，a-z，A-Z)，数据中的每8个位的字节都用ASCI码发送。</p>
</li>
<li>
<p>RTU模式: (Remote TerminalUnit，RTU)远程终端单元模式通信，针对通信距离较长和工业现场环境恶劣而设计的通信结构。特点:消息中每个8 bit的字节都包含量4bit的十六进制字符。</p>
</li>
<li>
<p>TCP模式：通过以太网和互联网连接传输数据使用的是TCP/P协议，称为TCP模式，硬件接口就是以太网(Fthernet)接口。</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="modbus-rtu消息帧格式">Modbus RTU消息帧格式<a href="#modbus-rtu消息帧格式" class="hash-link" aria-label="Direct link to Modbus RTU消息帧格式" title="Direct link to Modbus RTU消息帧格式">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520151128701.png" alt="image-20250520151128701" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="modbus数据存储区和功能码">Modbus数据存储区和功能码<a href="#modbus数据存储区和功能码" class="hash-link" aria-label="Direct link to Modbus数据存储区和功能码" title="Direct link to Modbus数据存储区和功能码">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="线圈和寄存器">线圈和寄存器<a href="#线圈和寄存器" class="hash-link" aria-label="Direct link to 线圈和寄存器" title="Direct link to 线圈和寄存器">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520151606597.png" alt="image-20250520151606597" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="功能码">功能码<a href="#功能码" class="hash-link" aria-label="Direct link to 功能码" title="Direct link to 功能码">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520152343524.png" alt="image-20250520152343524" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="modbus通讯模式">Modbus通讯模式<a href="#modbus通讯模式" class="hash-link" aria-label="Direct link to Modbus通讯模式" title="Direct link to Modbus通讯模式">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="主-从通讯">主-从通讯<a href="#主-从通讯" class="hash-link" aria-label="Direct link to 主-从通讯" title="Direct link to 主-从通讯">​</a></h4>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520152854738.png" alt="image-20250520152854738" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="主设备请求模式">主设备请求模式<a href="#主设备请求模式" class="hash-link" aria-label="Direct link to 主设备请求模式" title="Direct link to 主设备请求模式">​</a></h4>
<ol>
<li><strong>单播模式</strong>:主设备仅仅寻址单个从设备。从设备接收并处理完请求后，向主设备返回一个响应报文，即应答。
此模式下，要有两个Modbus报文:一个是主设备请求报文，一个是从设备响应报文。从设备地址必须唯一(1~247)。</li>
</ol>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520153029270.png" alt="image-20250520153029270" class="img_ev3q"></p>
<ol start="2">
<li><strong>广播模式</strong>:主设备可以向所有的从设备发送请求指令。从设备接收到广播指令后，仅仅做指令处理而不应答。此模式下，请求指令必须是“写”指令。根据协议要求，
所有从设备必须接收广播模式下的写指令，地址0被保留用来识别广播通信。</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="modbus报文解析实战">Modbus报文解析实战<a href="#modbus报文解析实战" class="hash-link" aria-label="Direct link to Modbus报文解析实战" title="Direct link to Modbus报文解析实战">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520153330272.png" alt="image-20250520153330272" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="基于modbus协议实现上位机程序开发">基于Modbus协议实现上位机程序开发<a href="#基于modbus协议实现上位机程序开发" class="hash-link" aria-label="Direct link to 基于Modbus协议实现上位机程序开发" title="Direct link to 基于Modbus协议实现上位机程序开发">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="项目ui设计注意问题">项目UI设计《注意问题》<a href="#项目ui设计注意问题" class="hash-link" aria-label="Direct link to 项目UI设计《注意问题》" title="Direct link to 项目UI设计《注意问题》">​</a></h3>
<p>缩放与布局的界面必须是100%，显示器分辨率使用推荐的分辨率。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520164721286.png" alt="image-20250520164721286" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="新建项目">新建项目<a href="#新建项目" class="hash-link" aria-label="Direct link to 新建项目" title="Direct link to 新建项目">​</a></h3>
<p>创建winforms类库，项目名scada.MyControls， 选择解决方案和项目不在同一目录，解决方案名称scada.THProject，运行环境.net8</p>
<p>删除scada.MyControls项目下默认Class.cs，添加项“用户窗口控件”，命名为THMeter.cs。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="温湿度显示问题">温湿度显示问题<a href="#温湿度显示问题" class="hash-link" aria-label="Direct link to 温湿度显示问题" title="Direct link to 温湿度显示问题">​</a></h3>
<p>控件界面大小宽度设置成73px，高度设置为203px。在控件上添加Panel控件，重命名为panelBg,宽度设置成73px，高度设置为203px。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520170935788.png" alt="image-20250520170935788" class="img_ev3q"></p>
<p>panelBg设置背景图像</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520171042137.png" alt="image-20250520171042137" class="img_ev3q"></p>
<p>添加Label到控件中，修改Text属性为“”，修改AutoSize属性为Flase,将BackColor设置成白色，将Width属性修改为10，Height属性设置为135</p>
<p>让Label完美覆盖到温度计的中心。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520171823396.png" alt="image-20250520171823396" class="img_ev3q">添加温度条的实现属性。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.ComponentModel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Drawing;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Linq;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Text;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Threading.Tasks;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace scada.MyControls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public partial class THMeter : UserControl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public THMeter()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InitializeComponent();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 设置温湿度柱状显示和实际温湿度显示【属性】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private int barHeight = 135;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public double SetHTValue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            get { return barHeight; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (value &lt; 0 || value &gt; 70)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    MessageBox.Show(&quot;温湿度必须在0-70之间！&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    double realValue = (barHeight/70.0) *value; // 实际值对应的高度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.lblBar.Height =  barHeight - Convert.ToInt32(realValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接下来测试下，选中解决方案，添加新项目，项目选择Windows窗体应用scada.THProjectMain，创建后重命名From1窗口为FromMain窗口</p>
<p>选中scada.MyControls项目，右击选择生成。查看工具箱这里，自定义的控件THMeter就会显示在这里,可以直接拖到FromMain窗口中。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520173007821.png" alt="image-20250520173007821" class="img_ev3q"></p>
<p>修改启动项，运行项目。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520173559115.png" alt="image-20250520173559115" class="img_ev3q"></p>
<p>将用户控件THMeter直接拖到FormMain中，在新建一个button控件</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520203144928.png" alt="image-20250520203144928" class="img_ev3q"></p>
<p>双击button1控件，添加按钮点击事件。在窗口初始化程序中给自定义的控件赋值。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">namespace scada.THProjectMain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public partial class FormMain : Form</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public FormMain()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InitializeComponent();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.thMeter1.SetHTValue = 20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private void button1_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.thMeter1.SetHTValue = 30;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接着运行主窗口。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/form.gif" alt="form" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="背景颜色的改变">背景颜色的改变<a href="#背景颜色的改变" class="hash-link" aria-label="Direct link to 背景颜色的改变" title="Direct link to 背景颜色的改变">​</a></h3>
<p>首先，将图片添加成资源，方便后面通过代码实现背景的切换。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520215728140.png" alt="image-20250520215728140" class="img_ev3q"></p>
<p>在panelBg这里设置背景的时候，选择项目资源文件，点击导入将green_all和red_all文件导入，默认选中green_all。修改THMeter.ms</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.ComponentModel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Drawing;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Data;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Linq;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Text;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Threading.Tasks;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Windows.Forms;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace scada.MyControls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public partial class THMeter : UserControl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public THMeter()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InitializeComponent();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 设置温湿度柱状显示和实际温湿度显示【属性】  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private int barHeight = 135;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public double SetHTValue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            get { return barHeight; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 设置温湿度值  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (0 &lt;= value &amp;&amp; value &lt;= 70 )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    double realValue = (barHeight / 70.0) * value; // 实际值对应的高度  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.lblBar.Height = barHeight - Convert.ToInt32(realValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if(value != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Console.WriteLine(&quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        MessageBox.Show(&quot;温湿度必须在0-70之间！&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 设置温湿度计的背景颜色【属性】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private BgColor bgColor = BgColor.Green;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public BgColor SetBackgroundColor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            get { return bgColor; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 设置背景颜色  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                bgColor = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (bgColor == BgColor.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.panelBg.BackgroundImage = Properties.Resources.green_all;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else if (bgColor == BgColor.Red) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.panelBg.BackgroundImage = Properties.Resources.red_all;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public enum BgColor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Green,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Red</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>再测试下，在FormMain中添加如下控件，并实现两个按钮的点击事件。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520221450728.png" alt="image-20250520221450728" class="img_ev3q"></p>
<p>FormMain.cs中实现按钮点击事件：</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using static scada.MyControls.THMeter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace scada.THProjectMain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public partial class FormMain : Form</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public FormMain()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InitializeComponent();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.thMeter1.SetHTValue = 20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.thMeter2.SetHTValue = 20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private void button1_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 点击按钮1，设置第一个温湿度计的值和背景颜色</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.thMeter1.SetHTValue = 30;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.thMeter1.SetBackgroundColor = BgColor.Green;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private void button2_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 点击按钮2，设置第2个温湿度计的值和背景颜色</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.thMeter2.SetHTValue = 50;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.thMeter2.SetBackgroundColor = BgColor.Red;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>运行后点击按钮，实现的效果如下：</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/thbg.gif" alt="thbg" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="温湿度值的显示">温湿度值的显示<a href="#温湿度值的显示" class="hash-link" aria-label="Direct link to 温湿度值的显示" title="Direct link to 温湿度值的显示">​</a></h3>
<p>接下来我们实现左边的控件显示温度，右边的控件显示湿度，并在控件下方使用静态文字标识，在文字的下方动态显示温度和湿度的值。</p>
<p>静态文字标识和温度和湿度的值都使用Label控件实现。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520225936817.png" alt="image-20250520225936817" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="连接参数界面">连接参数界面<a href="#连接参数界面" class="hash-link" aria-label="Direct link to 连接参数界面" title="Direct link to 连接参数界面">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250520231943384.png" alt="image-20250520231943384" class="img_ev3q"></p>
<p>按照上图绘制界面，按照红色标注设置控件名称。（这里湿度的文字写错了，lal_H和lal_T的命名掉换一下）</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="请求和应答报文的封装和解析">请求和应答报文的封装和解析<a href="#请求和应答报文的封装和解析" class="hash-link" aria-label="Direct link to 请求和应答报文的封装和解析" title="Direct link to 请求和应答报文的封装和解析">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="modbus报文通讯解析">Modbus报文通讯解析<a href="#modbus报文通讯解析" class="hash-link" aria-label="Direct link to Modbus报文通讯解析" title="Direct link to Modbus报文通讯解析">​</a></h4>
<p>在解决方案中创建新项目scada.ModbusBase,项目类型选择控制台程序。如果是.net8,需要手动安装 System.IO.Ports包。</p>
<div class="language-C# language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using System.IO;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.IO.Ports;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace scada.ModbusBase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    internal class Program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        static void Main(string[] args)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SerialPort serialPort = new SerialPort();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 设置串口参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            serialPort.PortName = &quot;COM12&quot;; // 串口号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            serialPort.BaudRate = 9600; // 波特率</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            serialPort.Parity = Parity.None; // 校验位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            serialPort.DataBits = 8; // 数据位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            serialPort.StopBits = StopBits.One; // 停止位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            serialPort.Handshake = Handshake.None; // 流控制</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            serialPort.ReadTimeout = 500; // 读取超时</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            serialPort.WriteTimeout = 500; // 写入超时</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 打开串口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                serialPort.Open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Console.WriteLine(&quot;串口已打开&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Console.WriteLine($&quot;打开串口失败: {ex.Message}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 循环读取数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Thread.Sleep(2000); // 延时2秒</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 拼接报文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                List&lt;byte&gt; sendBytes = new List&lt;byte&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sendBytes.Add(0x01); // 从站地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sendBytes.Add(0x03); // 功能码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sendBytes.Add(0x00); // 起始地址高字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sendBytes.Add(0x00); // 起始地址低字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sendBytes.Add(0x00); // 寄存器数量高字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sendBytes.Add(0x02); // 寄存器数量低字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                     // CRC校验</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sendBytes.Add(0xC4); // CRC高字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sendBytes.Add(0x0B); // CRC低字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 发送报文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                serialPort.Write(sendBytes.ToArray(), 0, sendBytes.Count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 接收延时</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Thread.Sleep(100);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 读取serialPort数据   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    byte[] receiveBytes = new byte[serialPort.BytesToRead];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // 接受缓冲区的全部字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    serialPort.Read(receiveBytes, 0, receiveBytes.Length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (receiveBytes[0] == 0x01)    // 判断地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 接收报文： 01  03  04  00  01  00  01  6A  33</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 转成10进制： 1   3   4   0   1   0   1   106 51</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 数据索引：[0] [1] [2]  [3] [4] [5] [6] [7] [8]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 数组字节到10进制高低字转换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 第一个寄存器温度，高字节在前，低字节在后</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        int highByte_temperature = receiveBytes[3]; // 高字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        int lowByte_temperature = receiveBytes[4]; // 低字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        int value_temperature = (highByte_temperature &lt;&lt; 8) + lowByte_temperature; // 合并高低字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        int highByte_humidity = receiveBytes[5]; // 高字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        int lowBytee_humidity = receiveBytes[6]; // 低字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        int value_humidity = (highByte_humidity &lt;&lt; 8) + lowBytee_humidity; // 合并高低字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        string humidity = (value_humidity * 0.1).ToString(&quot;0.0&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        string temperature = (value_temperature * 0.1).ToString(&quot;0.0&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Console.WriteLine($&quot;湿度:{humidity}% 温度:{temperature}℃&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                catch (TimeoutException)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Console.WriteLine(&quot;读取超时&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Console.WriteLine($&quot;读取数据失败: {ex.Message}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用Modbus slave 工具模拟一个Modbus服务端，运行控制台程序，这里创建了虚拟串口<code>COM11&lt;--&gt;COM12</code>，创建方式不过多赘述。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250521131401556.png" alt="image-20250521131401556" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="modbus-rtu通讯类">Modbus RTU通讯类<a href="#modbus-rtu通讯类" class="hash-link" aria-label="Direct link to Modbus RTU通讯类" title="Direct link to Modbus RTU通讯类">​</a></h4>
<p>在解决方案中创建新项目scada.ModbusRTUlib,项目类型选择类库。在项目下添加ModbusRTU.cs。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Linq;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Text;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Threading.Tasks;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 引入命名空间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Threading;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.IO.Ports;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Runtime.InteropServices;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace scada.ModbusRTUlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// Modbus RTU协议实现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class ModbusRTU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 字段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private SerialPort serialPort = null; // 串口对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 构造方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public ModbusRTU()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// 有参构造方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;param name=&quot;delay&quot;&gt;接收延时&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public ModbusRTU(int delay)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.ReceiveDelay = delay; // 接收延时</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 属性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private int _receivedelay = 100; // 接收延时</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public int ReceiveDelay</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            get { return _receivedelay; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (value &lt; 0 || value &gt; 2000) // </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    _receivedelay = 100;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    _receivedelay = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 方法（打开串口、关闭串口、读保持寄存器03H, CRC校验）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// 打开串口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;param name=&quot;portName&quot;&gt;串口号&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;param name=&quot;baudRate&quot;&gt;波特率&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;param name=&quot;parity&quot;&gt;校验位&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;param name=&quot;dataBits&quot;&gt;数据位&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;param name=&quot;stopBits&quot;&gt;停止位&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void OpenPort(string portName, int baudRate = 9600,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Parity parity = Parity.None, int dataBits = 8,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            StopBits stopBits = StopBits.One)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 创建串口对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            serialPort = new SerialPort(portName, baudRate, parity, dataBits, stopBits);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 打开串口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                serialPort.Open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                throw new Exception($&quot;打开串口失败: {ex.Message}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// 关闭串口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void ClosePort()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (serialPort != null &amp;&amp; serialPort.IsOpen)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                serialPort.Close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// 读取保持寄存器03H</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;param name=&quot;slaveAddress&quot;&gt;从站地址&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;param name=&quot;startAddress&quot;&gt;起始寄存器地址&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;param name=&quot;registerCount&quot;&gt;寄存器个数&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;returns&gt;&lt;/returns&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;exception cref=&quot;Exception&quot;&gt;&lt;/exception&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public byte[] ReadHoldingRegisters(byte slaveAddress, ushort startAddress, ushort registerCount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 第一步：封装请求报文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            List&lt;byte&gt; sendBytes = new List&lt;byte&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sendBytes.Add(slaveAddress); // 从站地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sendBytes.Add(0x03); // 功能码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sendBytes.Add((byte)(startAddress &gt;&gt; 8)); // 起始地址高字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sendBytes.Add((byte)(startAddress &amp; 0xFF)); // 起始地址低字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sendBytes.Add((byte)(registerCount &gt;&gt; 8)); // 寄存器数量高字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sendBytes.Add((byte)(registerCount &amp; 0xFF)); // 寄存器数量低字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                         // CRC校验</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] crc = CRC16(sendBytes.ToArray(), 6);//封装CRC校验校验前面6位</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sendBytes.Add((crc[0])); // CRC低字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sendBytes.Add((crc[1])); // CRC高字节</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 第二步：发送请求报文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] receiveBytes = null; // 定义接收字节数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (serialPort == null || !serialPort.IsOpen)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    throw new Exception(&quot;串口未打开&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                serialPort.Write(sendBytes.ToArray(), 0, sendBytes.Count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 接收延时</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Thread.Sleep(ReceiveDelay);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 第三步：接收响应报文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 读取serialPort数据   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    receiveBytes = new byte[serialPort.BytesToRead];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    serialPort.Read(receiveBytes, 0, receiveBytes.Length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    throw new Exception($&quot;读取数据失败: {ex.Message}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                throw new Exception($&quot;发送数据失败: {ex.Message}&quot;); ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 第四步：解析响应报文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (receiveBytes.Length == 5 + 2 * registerCount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                //进一步校验</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if  ( receiveBytes[1] == 0x03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &amp;&amp; receiveBytes[2] == registerCount*2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    byte[] returnDataArray = new byte[registerCount*2];//用于返回的数据数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //返回截取后只包括数据的数组（从索引3开始（去掉地址、功能码、字节计数），</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    //目的数组，从0开始，复制数据长度）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Array.Copy(receiveBytes, 3, returnDataArray, 0, registerCount*2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    return returnDataArray;//返回的数组，只包括数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            else return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #region  CRC校验【查表法，速度很快】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private static readonly byte[] aucCRCHi = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x00, 0xC1, 0x81, 0x40,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x00, 0xC1, 0x81, 0x40,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x00, 0xC1, 0x81, 0x40,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x01, 0xC0, 0x80, 0x41, 0x01, 0xC0, 0x80, 0x41, 0x00, 0xC1, 0x81, 0x40,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x00, 0xC1, 0x81, 0x40,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x01, 0xC0, 0x80, 0x41, 0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x00, 0xC1, 0x81, 0x40,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40, 0x01, 0xC0, 0x80, 0x41, 0x01, 0xC0, 0x80, 0x41,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC1, 0x81, 0x40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private static readonly byte[] aucCRCLo = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x00, 0xC0, 0xC1, 0x01, 0xC3, 0x03, 0x02, 0xC2, 0xC6, 0x06, 0x07, 0xC7,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x05, 0xC5, 0xC4, 0x04, 0xCC, 0x0C, 0x0D, 0xCD, 0x0F, 0xCF, 0xCE, 0x0E,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x0A, 0xCA, 0xCB, 0x0B, 0xC9, 0x09, 0x08, 0xC8, 0xD8, 0x18, 0x19, 0xD9,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x1B, 0xDB, 0xDA, 0x1A, 0x1E, 0xDE, 0xDF, 0x1F, 0xDD, 0x1D, 0x1C, 0xDC,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x14, 0xD4, 0xD5, 0x15, 0xD7, 0x17, 0x16, 0xD6, 0xD2, 0x12, 0x13, 0xD3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x11, 0xD1, 0xD0, 0x10, 0xF0, 0x30, 0x31, 0xF1, 0x33, 0xF3, 0xF2, 0x32,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x36, 0xF6, 0xF7, 0x37, 0xF5, 0x35, 0x34, 0xF4, 0x3C, 0xFC, 0xFD, 0x3D,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0xFF, 0x3F, 0x3E, 0xFE, 0xFA, 0x3A, 0x3B, 0xFB, 0x39, 0xF9, 0xF8, 0x38,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x28, 0xE8, 0xE9, 0x29, 0xEB, 0x2B, 0x2A, 0xEA, 0xEE, 0x2E, 0x2F, 0xEF,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x2D, 0xED, 0xEC, 0x2C, 0xE4, 0x24, 0x25, 0xE5, 0x27, 0xE7, 0xE6, 0x26,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x22, 0xE2, 0xE3, 0x23, 0xE1, 0x21, 0x20, 0xE0, 0xA0, 0x60, 0x61, 0xA1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x63, 0xA3, 0xA2, 0x62, 0x66, 0xA6, 0xA7, 0x67, 0xA5, 0x65, 0x64, 0xA4,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x6C, 0xAC, 0xAD, 0x6D, 0xAF, 0x6F, 0x6E, 0xAE, 0xAA, 0x6A, 0x6B, 0xAB,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x69, 0xA9, 0xA8, 0x68, 0x78, 0xB8, 0xB9, 0x79, 0xBB, 0x7B, 0x7A, 0xBA,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0xBE, 0x7E, 0x7F, 0xBF, 0x7D, 0xBD, 0xBC, 0x7C, 0xB4, 0x74, 0x75, 0xB5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x77, 0xB7, 0xB6, 0x76, 0x72, 0xB2, 0xB3, 0x73, 0xB1, 0x71, 0x70, 0xB0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x50, 0x90, 0x91, 0x51, 0x93, 0x53, 0x52, 0x92, 0x96, 0x56, 0x57, 0x97,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x55, 0x95, 0x94, 0x54, 0x9C, 0x5C, 0x5D, 0x9D, 0x5F, 0x9F, 0x9E, 0x5E,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x5A, 0x9A, 0x9B, 0x5B, 0x99, 0x59, 0x58, 0x98, 0x88, 0x48, 0x49, 0x89,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x4B, 0x8B, 0x8A, 0x4A, 0x4E, 0x8E, 0x8F, 0x4F, 0x8D, 0x4D, 0x4C, 0x8C,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x44, 0x84, 0x85, 0x45, 0x87, 0x47, 0x46, 0x86, 0x82, 0x42, 0x43, 0x83,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             0x41, 0x81, 0x80, 0x40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private byte[] CRC16(byte[] pucFrame, int usLen)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int i = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] res = new byte[2] { 0xFF, 0xFF };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ushort iIndex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (usLen-- &gt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                iIndex = (ushort)(res[0] ^ pucFrame[i++]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                res[0] = (byte)(res[1] ^ aucCRCHi[iIndex]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                res[1] = aucCRCLo[iIndex];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return res;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private bool CheckCRC(byte[] value)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (value == null) return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (value.Length &lt;= 2) return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int length = value.Length;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] buf = new byte[length - 2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Array.Copy(value, 0, buf, 0, buf.Length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] CRCbuf = CRC16(buf, buf.Length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (CRCbuf[0] == value[length - 2] &amp;&amp; CRCbuf[1] == value[length - 1])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #endregion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="项目中使用通讯类">项目中使用通讯类<a href="#项目中使用通讯类" class="hash-link" aria-label="Direct link to 项目中使用通讯类" title="Direct link to 项目中使用通讯类">​</a></h3>
<p>将ModbusRTUlib项目引用到THProjectMain项目中。</p>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250521145549480.png" alt="image-20250521145549480" class="img_ev3q"></p>
<p>修改FromMain.cs实现后端逻辑。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using static scada.MyControls.THMeter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.IO.Ports;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using scada.ModbusRTUlib;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using scada.MyControls;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace scada.THProjectMain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public partial class FormMain : Form</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 创建通信类对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ModbusRTU modbusRTU = new ModbusRTU();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public FormMain()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            InitializeComponent();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Init();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// 初始化上下文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private void Init()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 绑定波特率的下拉框</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            string[] baudRates = { &quot;2400&quot;, &quot;4800&quot;, &quot;9600&quot;, &quot;115200&quot;, &quot;19200&quot;, &quot;38400&quot; };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.cmb_BaudRate.Items.AddRange(baudRates);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.cmb_BaudRate.SelectedIndex = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 当前可用的串口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.cmb_PortName.DataSource = SerialPort.GetPortNames();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 定时器设置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.timer1.Interval = 1000; // 1秒</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private bool _isConnected = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public bool IsConnected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            get { return _isConnected; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                _isConnected = value; // 保存当前状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                this.btn_OpenAndClose.Text = _isConnected ? &quot;断开连接&quot; : &quot;打开连接&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (value)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // 如果连接成功，设置按钮颜色</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.btn_OpenAndClose.BackColor = Color.Red;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.btn_OpenAndClose.ForeColor = Color.White;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.lbl_Status.ForeColor = Color.Green;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.btn_OpenAndClose.BackColor = Color.Green;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.btn_OpenAndClose.ForeColor = Color.White;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.lbl_Status.ForeColor = Color.Red;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 打开和关闭串口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private void btn_OpenAndClose_Click(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (!IsConnected)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    modbusRTU.OpenPort(this.cmb_PortName.Text,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Convert.ToInt32(this.cmb_BaudRate.Text));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    IsConnected = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.timer1.Start(); // 启动定时器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    MessageBox.Show(&quot;打开串口失败！&quot; + ex.Message);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.timer1.Stop(); // 先停止定时器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    modbusRTU.ClosePort();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    IsConnected = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    MessageBox.Show(&quot;关闭串口失败！&quot; + ex.Message);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #region 定时循环读取寄存器数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private void timer1_Tick(object sender, EventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 读取数据（2个寄存器，起始地址：0000H）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] data = modbusRTU.ReadHoldingRegisters(Convert.ToByte(this.cmb_Slaved.Text), 0, 2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (data != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 解析数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                int temperature = (data[0] &lt;&lt; 8) + data[1]; // 温度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                int humidity = (data[2] &lt;&lt; 8) + data[3]; // 湿度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                         // 显示数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 设置温湿度计的显示值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (temperature &gt;= 0 &amp;&amp; temperature &lt;= 70)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.thMeter1.SetHTValue = temperature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.lal_T.Text = temperature.ToString(&quot;0.0&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (temperature &gt;= 45 &amp;&amp; temperature &lt; 70)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (this.thMeter1.SetBackgroundColor == THMeter.BgColor.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            this.thMeter1.SetBackgroundColor = THMeter.BgColor.Red;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (this.thMeter1.SetBackgroundColor == THMeter.BgColor.Red)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            this.thMeter1.SetBackgroundColor = THMeter.BgColor.Green;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.thMeter1.SetHTValue = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.lal_T.Text = &quot;err&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (this.thMeter1.SetBackgroundColor == THMeter.BgColor.Red)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        this.thMeter1.SetBackgroundColor = THMeter.BgColor.Green;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (humidity &gt;= 0 &amp;&amp; humidity &lt;= 700)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.thMeter2.SetHTValue = humidity*0.1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.lal_H.Text = (humidity * 0.1).ToString(&quot;0.0&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if(humidity &gt;= 450 &amp;&amp; humidity &lt;= 700)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (this.thMeter2.SetBackgroundColor == THMeter.BgColor.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            this.thMeter2.SetBackgroundColor = THMeter.BgColor.Red;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (this.thMeter2.SetBackgroundColor == THMeter.BgColor.Red)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            this.thMeter2.SetBackgroundColor = THMeter.BgColor.Green;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.thMeter2.SetHTValue = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    this.lal_H.Text = &quot;err&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (this.thMeter2.SetBackgroundColor == THMeter.BgColor.Red)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        this.thMeter2.SetBackgroundColor = THMeter.BgColor.Green;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #endregion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="最终实现的效果">最终实现的效果<a href="#最终实现的效果" class="hash-link" aria-label="Direct link to 最终实现的效果" title="Direct link to 最终实现的效果">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/mth.gif" alt="mth" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/haochan1996/haochan1996.github.io/tree/main/docs/sacda_dev/Modbus温度采集项目实战.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/c上位机开发"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">C#上位机开发</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/autojs使用"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">auto.js使用</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#rs-485串口通讯基础" class="table-of-contents__link toc-highlight">RS-485串口通讯基础</a><ul><li><a href="#串口通讯硬件接线" class="table-of-contents__link toc-highlight">串口通讯硬件接线</a></li><li><a href="#串口通讯数据流和格式" class="table-of-contents__link toc-highlight">串口通讯数据流和格式</a></li><li><a href="#串行通信格式单字节协议" class="table-of-contents__link toc-highlight">串行通信格式（单字节协议）</a></li></ul></li><li><a href="#modbus通讯协议" class="table-of-contents__link toc-highlight">Modbus通讯协议</a><ul><li><a href="#关于通讯协议" class="table-of-contents__link toc-highlight">关于通讯协议</a></li><li><a href="#modbus-rtu消息帧格式" class="table-of-contents__link toc-highlight">Modbus RTU消息帧格式</a></li><li><a href="#modbus数据存储区和功能码" class="table-of-contents__link toc-highlight">Modbus数据存储区和功能码</a></li><li><a href="#modbus通讯模式" class="table-of-contents__link toc-highlight">Modbus通讯模式</a></li><li><a href="#modbus报文解析实战" class="table-of-contents__link toc-highlight">Modbus报文解析实战</a></li></ul></li><li><a href="#基于modbus协议实现上位机程序开发" class="table-of-contents__link toc-highlight">基于Modbus协议实现上位机程序开发</a><ul><li><a href="#项目ui设计注意问题" class="table-of-contents__link toc-highlight">项目UI设计《注意问题》</a></li><li><a href="#新建项目" class="table-of-contents__link toc-highlight">新建项目</a></li><li><a href="#温湿度显示问题" class="table-of-contents__link toc-highlight">温湿度显示问题</a></li><li><a href="#背景颜色的改变" class="table-of-contents__link toc-highlight">背景颜色的改变</a></li><li><a href="#温湿度值的显示" class="table-of-contents__link toc-highlight">温湿度值的显示</a></li><li><a href="#连接参数界面" class="table-of-contents__link toc-highlight">连接参数界面</a></li><li><a href="#请求和应答报文的封装和解析" class="table-of-contents__link toc-highlight">请求和应答报文的封装和解析</a></li><li><a href="#项目中使用通讯类" class="table-of-contents__link toc-highlight">项目中使用通讯类</a></li><li><a href="#最终实现的效果" class="table-of-contents__link toc-highlight">最终实现的效果</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/haochan1996/haochan1996.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 陈浩的博客, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>