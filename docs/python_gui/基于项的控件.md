---
siderbar: 1
---

## 【实例1-1】 创建一个窗口，该窗口包含一个列表控件。要求在列表控件中显示项，设置背景色，

![image-20250414212651864](https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250414212651864.png)

代码如下：

```python
import sys
from PySide6.QtGui import QFont
from PySide6.QtWidgets import (
    QApplication,
    QWidget,
    QVBoxLayout,
    QListWidget,
    QPushButton,
    QHBoxLayout,
    QInputDialog,
    QLineEdit,
    QMessageBox,
)


class Window(QWidget):
    def __init__(self):
        super().__init__()
        self.setGeometry(200, 200, 560, 260)
        self.setWindowTitle("QListWidget")
        
        # 创建垂直布局并设置为当前控件的布局方式
        vbox = QVBoxLayout()
        self.setLayout(vbox)

        # 创建列表控件
        self.listwidget = QListWidget()
        self.listwidget.setFont(QFont("黑体", 14))
        self.listwidget.setStyleSheet("background-color:yellowgreen")
        # 添加到布局控件中
        vbox.addWidget(self.listwidget)
        
        # 插入项
        self.listwidget.insertItem(0, "python")
        self.listwidget.insertItem(1, "go")
        self.listwidget.insertItem(2, "c++")


if __name__ == "__main__":
    app = QApplication(sys.argv)
    win = Window()
    win.show()
    sys.exit(app.exec())
```

## 【实例1-2】 创建一个窗口，该窗口包含一个列表控件、4个按钮控件。这4个按钮分别实现添加项、编辑项、删除项、排序的作用。

![image-20250414213634547](https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/image-20250414213634547.png)

代码如下：

```python
import sys
from PySide6.QtGui import QFont
from PySide6.QtWidgets import (
    QApplication,
    QWidget,
    QVBoxLayout,
    QListWidget,
    QPushButton,
    QHBoxLayout,
    QInputDialog,
    QLineEdit,
    QMessageBox,
)

class Window(QWidget):
    def __init__(self):
        super().__init__()
        self.setGeometry(200, 200, 560, 260)
        self.setWindowTitle("QListWidget QListWidgetItem")

        vbox = QVBoxLayout()
        self.setLayout(vbox)
        # 创建4个按钮
        btn_add = QPushButton("添加")
        btn_edit = QPushButton("编辑")
        btn_remove = QPushButton("删除")
        btn_sort = QPushButton("排序")

        hbox = QHBoxLayout()
        hbox.addWidget(btn_add)
        hbox.addWidget(btn_edit)
        hbox.addWidget(btn_remove)
        hbox.addWidget(btn_sort)
        vbox.addLayout(hbox)
        # 使用信号/槽
        btn_add.clicked.connect(self.add_item)
        btn_edit.clicked.connect(self.edit_item)
        btn_remove.clicked.connect(self.remove_item)
        btn_sort.clicked.connect(self.sort_item)
        hbox.addWidget(btn_add)
        hbox.addWidget(btn_edit)
        hbox.addWidget(btn_remove)
        hbox.addWidget(btn_sort)

        # 创建列表控件
        self.listwidget = QListWidget()
        self.listwidget.setFont(QFont("黑体", 14))
        vbox.addWidget(self.listwidget)

    def add_item(self):
        row = self.listwidget.currentRow()
        title = "添加项"
        data, ok = QInputDialog.getText(self, title, title)  # 弹出对话框
        if ok and data is not None:
            self.listwidget.insertItem(row, data)

    def edit_item(self):
        item = self.listwidget.currentItem()
        if item is not None:
            title = "编辑项"
            data, ok = QInputDialog.getText(
                self, title, title, QLineEdit.EchoMode.Normal, item.text()
            )
            if ok and data is not None:
                item.setText(data)

    def remove_item(self):
        row = self.listwidget.currentRow()
        item = self.listwidget.item(row)
        if item == None:
            return
        title1 = "删除项"
        title2 = "确定要删除？"
        reply = QMessageBox.question(
            self, title1, title2, QMessageBox.Yes | QMessageBox.No
        )
        if reply == QMessageBox.Yes:
            self.listwidget.takeItem(row)

    def sort_item(self):
        self.listwidget.sortItems()


if __name__ == "__main__":
    app = QApplication(sys.argv)
    win = Window()
    win.show()
    sys.exit(app.exec())

```

## 【实例1-3】 创建一个窗口，该窗口包含一个列表控件。在列表控件中右击会弹出上下文菜单，菜单命令包含添加、编辑、删除、全选、反选、全不选。

![listwidget](https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/listwidget.gif)

代码如下：

```python
"""
创建一个窗口，该窗口包含一个列表控件。在列表控件中右击会弹出上下文菜单，菜单命令包含添加、编辑、删除、全选、反选、全不选
"""

import sys
from PySide6.QtGui import QFont
from PySide6.QtWidgets import (
    QApplication,
    QWidget,
    QVBoxLayout,
    QListWidget,
    QPushButton,
    QHBoxLayout,
    QInputDialog,
    QLineEdit,
    QMessageBox,
    QMenu,
)
from PySide6.QtCore import Qt


class Window(QWidget):
    def __init__(self):
        super().__init__()
        self.setGeometry(200, 200, 560, 260)
        self.setWindowTitle("QListWidget QListWidgetItem")

        vbox = QVBoxLayout()
        self.setLayout(vbox)

        # 创建列表控件
        self.listwidget = QListWidget()
        self.listwidget.setFont(QFont("黑体", 14))
        vbox.addWidget(self.listwidget)

    def contextMenuEvent(self, event):
        """在PyQt中，contextMenuEvent用于处理右键菜单事件，当用户右击部件时会触发。"""
        contextMenu = QMenu(self)
        contextMenu.addAction("添加").triggered.connect(self.add_item)
        contextMenu.addAction("编辑").triggered.connect(self.edit_item)
        contextMenu.addAction("删除").triggered.connect(self.remove_item)
        contextMenu.addSeparator()  # 添加分割线
        contextMenu.addAction("全选").triggered.connect(self.select_all)
        contextMenu.addAction("反选").triggered.connect(self.inverse_select)
        contextMenu.addAction("全不选").triggered.connect(self.select_none)
        contextMenu.exec(event.globalPos())

    def add_item(self):
        """插入新项"""
        row = self.listwidget.currentRow()  # 获取当前选中项的index
        print(row)
        title = "添加项"
        data, ok = QInputDialog.getText(self, title, title)
        if ok and data is not None:
            self.listwidget.insertItem(row, data)

    def edit_item(self):
        """编辑项"""
        item = self.listwidget.currentItem()
        if item is not None:
            title = "编辑项"
            data, ok = QInputDialog.getText(
                self, title, title, QLineEdit.EchoMode.Normal, item.text()
            )
            if ok and data is not None:
                item.setText(data)

    def remove_item(self):
        """删除项"""
        row = self.listwidget.currentRow()
        item = self.listwidget.item(row)
        if item == None:
            return
        title1 = "删除项"
        title2 = "确定要删除？"
        reply = QMessageBox.question(
            self, title1, title2, QMessageBox.Yes | QMessageBox.No
        )
        if reply == QMessageBox.Yes:
            self.listwidget.takeItem(row)

    def select_all(self):
        """选择所有项"""
        count = self.listwidget.count()
        for i in range(count):
            item = self.listwidget.item(i)
            item.setCheckState(Qt.Checked)

    def inverse_select(self):
        """反选"""
        count = self.listwidget.count()
        for i in range(count):
            item = self.listwidget.item(i)
            if item.checkState() == Qt.Unchecked:
                item.setCheckState(Qt.Checked)
            else:
                item.setCheckState(Qt.Unchecked)

    def select_none(self):
        """全不选"""
        count = self.listwidget.count()
        for i in range(count):
            item = self.listwidget.item(i)
            item.setCheckState(Qt.Unchecked)


if __name__ == "__main__":
    app = QApplication(sys.argv)
    win = Window()
    win.show()
    sys.exit(app.exec())

```

