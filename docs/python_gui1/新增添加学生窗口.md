---
sidebar_position: 5
---

# 新增添加学生窗口

实现添加学生信息窗口，当点击`新增`按钮，弹出添加信息框。

在`student`文件夹新建`student_dialog.py`文件。

```python
# student_dialog.py
from qfluentwidgets import MessageBoxBase, LineEdit, ComboBox, StrongBodyLabel, SubtitleLabel
from PySide6.QtWidgets import QGridLayout
from PySide6.QtCore import Qt


class BaseStudentDialog(MessageBoxBase):
    def __init__(self, title, parent=None):
        super().__init__(parent)
        self.title = title
        self.setup_ui()

    def setup_ui(self):
        self.titleLabel = SubtitleLabel(self.title, self)
        self.viewLayout.addWidget(self.titleLabel)
        self.viewLayout.setAlignment(self.titleLabel, Qt.AlignmentFlag.AlignCenter)
        
        # 创建QGrideLayout布局
        grid_layout = QGridLayout()
        self.viewLayout.addLayout(grid_layout)

        # 创建字段
        self.nameInput = LineEdit(self)
        self.numberInput = LineEdit(self)
        self.genderCombo = ComboBox(self)
        self.genderCombo.addItems(["男", "女"])
        self.classCombo = ComboBox(self)
        self.chineseInput = LineEdit(self)
        self.mathInput = LineEdit(self)
        self.englishInput = LineEdit(self)

        # 添加字段到网格布局
        fields = [
            ("姓名", self.nameInput),
            ("学号", self.numberInput),
            ("性别", self.genderCombo),
            ("班级", self.classCombo),
            ("语文", self.chineseInput),
            ("数学", self.mathInput),
            ("英语", self.englishInput),
        ]

        for row, (label_text, widget) in enumerate(fields):
            label = StrongBodyLabel(label_text, self)
            grid_layout.addWidget(label, row, 0)  # 每一行的第2列
            grid_layout.addWidget(widget, row, 1)  # 每一行的第2列

        # 设置列拉伸
        grid_layout.setColumnStretch(1, 1)

        # 设置左对齐
        grid_layout.setAlignment(Qt.AlignmentFlag.AlignLeft)

        self.yesButton.setText("确认")
        self.cancelButton.setText("取消")

        # 设置输入框的宽度
        for widget in [
            self.nameInput,
            self.numberInput,
            self.genderCombo,
            self.classCombo,
            self.chineseInput,
            self.mathInput,
            self.englishInput,
        ]:
            widget.setMinimumWidth(200)

        # 将焦点定位到姓名输入框
        self.nameInput.setFocus()

        # 确保“确定”按钮不会自动对焦
        self.yesButton.setDefault(False)
        self.yesButton.setAutoDefault(False)


class AddStudentDialog(BaseStudentDialog):
    def __init__(self, parent=None):
        super().__init__("添加学生", parent)
        self.student_id = None
        self.yesButton.setText("添加")

```

接下来实现按钮的信号和槽函数：

```python
# student_interface.py

# ...
from student.student_dialog import *


# ...
        self.add_button = PushButton("新增", self)
        setCustomStyleSheet(self.add_button, ADD_BUTTON_STYLE, ADD_BUTTON_STYLE)
        self.add_button.clicked.connect(self.add_student)
        
# ...

    def add_student(self):
        """添加学生信息
        """        
        dialog = AddStudentDialog(self)
        if dialog.exec():
            print("用户点击了添加按钮")
        else:
            print("用户点击了取消按钮")
```

接着运行`main.py`，显示的效果如下：

![listwidget](https://blog-1301697820.cos.ap-guangzhou.myqcloud.com/blog/listwidget.gif)
